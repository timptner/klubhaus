{{ errors }}

{% if errors and not fields %}
    <div>{% for field in hidden_fields %}{{ field }}{% endfor %}</div>
{% endif %}

{% for field, errors in fields %}
    <div {% with classes=field.css_classes %}{% if classes %} class="{{ classes }}"{% else %}class="field"{% endif %}{% endwith %}>
    {% if field.use_fieldset %}
        <fieldset>
        {% if field.label %}{{ field.legend_tag }}{% endif %}
    {% else %}
        {% if field.field.widget.input_type != 'checkbox' %}
            {% if field.label %}{{ field.label_tag }}{% endif %}
        {% endif %}
    {% endif %}

    <div class="control">
        {% if field.field.widget.input_type == 'checkbox' %}
            <label class="checkbox">
                {{ field }}
                {{ field.label }}
            </label>
        {% else %}
            {{ field }}
        {% endif %}
    </div>

    {% if field.help_text %}<p class="help">{{ field.help_text|safe }}</p>{% endif %}

    {{ errors }}

    {% if field.use_fieldset %}
        </fieldset>
    {% endif %}

    {% if forloop.last %}
        {% for field in hidden_fields %}{{ field }}{% endfor %}
    {% endif %}

    </div>
{% endfor %}

{% if not fields and not errors %}
    {% for field in hidden_fields %}{{ field }}{% endfor %}
{% endif %}
